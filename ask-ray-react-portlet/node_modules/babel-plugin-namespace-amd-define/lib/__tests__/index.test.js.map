{"version":3,"sources":["../../src/__tests__/index.test.js"],"names":["babel","logger","beforeEach","set","__filename","it","source","transform","filenameRelative","plugins","expect","messages","toMatchSnapshot","code","describe"],"mappings":";;AAAA;;IAAYA,K;;AACZ;;;;AACA;;;;;;;;AAEA,IAAIC,eAAJ;;AAEAC,WAAW,YAAM;AAChB,wBAAaC,GAAb,CAAiBC,UAAjB,EAA8BH,SAAS,4BAAvC;AACA,CAFD;;AAIAI,GAAG,wBAAH,EAA6B,YAAM;AAClC,KAAMC,iIAAN;;AAOAN,OAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACvBE,oBAAkBJ,UADK;AAEvBK,WAAS;AAFc,EAAxB;;AAKAC,QAAOT,OAAOU,QAAd,EAAwBC,eAAxB;AACA,CAdD;;AAgBAP,GAAG,qCAAH,EAA0C,YAAM;AAC/C,KAAMC,2CAAN;;AAD+C,wBAKhCN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,oBAAkBJ,UADoB;AAEtCK,WAAS;AAF6B,EAAxB,CALgC;AAAA,KAKxCI,IALwC,oBAKxCA,IALwC;;AAU/CH,QAAOG,IAAP,EAAaD,eAAb;AACA,CAXD;;AAaAP,GAAG,mDAAH,EAAwD,YAAM;AAC7D,KAAMC,2DAAN;;AAD6D,yBAK9CN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,oBAAkBJ,UADoB;AAEtCK,WAAS;AAF6B,EAAxB,CAL8C;AAAA,KAKtDI,IALsD,qBAKtDA,IALsD;;AAU7DH,QAAOG,IAAP,EAAaD,eAAb;AACA,CAXD;;AAaAP,GAAG,mDAAH,EAAwD,YAAM;AAC7D,KAAMC,qGAAN;;AAD6D,yBAO9CN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,oBAAkBJ,UADoB;AAEtCK,WAAS;AAF6B,EAAxB,CAP8C;AAAA,KAOtDI,IAPsD,qBAOtDA,IAPsD;;AAY7DH,QAAOG,IAAP,EAAaD,eAAb;AACA,CAbD;;AAeAE,SAAS,0DAAT,EAAqE,YAAM;AAC1ET,IAAG,uBAAH,EAA4B,YAAM;AACjC,MAAMC,8HAAN;;AADiC,0BAWlBN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,qBAAkBJ,UADoB;AAEtCK,YAAS;AAF6B,GAAxB,CAXkB;AAAA,MAW1BI,IAX0B,qBAW1BA,IAX0B;;AAgBjCH,SAAOG,IAAP,EAAaD,eAAb;AACA,EAjBD;;AAmBAP,IAAG,iCAAH,EAAsC,YAAM;AAC3C,MAAMC,gFAAN;;AAD2C,0BAO5BN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,qBAAkBJ,UADoB;AAEtCK,YAAS;AAF6B,GAAxB,CAP4B;AAAA,MAOpCI,IAPoC,qBAOpCA,IAPoC;;AAY3CH,SAAOG,IAAP,EAAaD,eAAb;AACA,EAbD;;AAeAP,IAAG,uBAAH,EAA4B,YAAM;AACjC,MAAMC,8EAAN;;AADiC,0BAOlBN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,qBAAkBJ,UADoB;AAEtCK,YAAS;AAF6B,GAAxB,CAPkB;AAAA,MAO1BI,IAP0B,qBAO1BA,IAP0B;;AAYjCH,SAAOG,IAAP,EAAaD,eAAb;AACA,EAbD;;AAeAP,IAAG,4BAAH,EAAiC,YAAM;AACtC,MAAMC,yHAAN;;AADsC,0BASvBN,MAAMO,SAAN,CAAgBD,MAAhB,EAAwB;AACtCE,qBAAkBJ,UADoB;AAEtCK,YAAS;AAF6B,GAAxB,CATuB;AAAA,MAS/BI,IAT+B,qBAS/BA,IAT+B;;AActCH,SAAOG,IAAP,EAAaD,eAAb;AACA,EAfD;AAgBA,CAlED","file":"index.test.js","sourcesContent":["import * as babel from 'babel-core';\nimport PluginLogger from 'liferay-npm-build-tools-common/lib/plugin-logger';\nimport plugin from '../index';\n\nlet logger;\n\nbeforeEach(() => {\n\tPluginLogger.set(__filename, (logger = new PluginLogger()));\n});\n\nit('logs results correctly', () => {\n\tconst source = `\n\tdefine([], function(){})\n\tif (typeof define === \"function\" && define.amd) {\n\t\tconsole.log('UMD!');\n\t}\n\t`;\n\n\tbabel.transform(source, {\n\t\tfilenameRelative: __filename,\n\t\tplugins: [plugin],\n\t});\n\n\texpect(logger.messages).toMatchSnapshot();\n});\n\nit('namespaces unqualified define calls', () => {\n\tconst source = `\n\tdefine([], function(){})\n\t`;\n\n\tconst {code} = babel.transform(source, {\n\t\tfilenameRelative: __filename,\n\t\tplugins: [plugin],\n\t});\n\n\texpect(code).toMatchSnapshot();\n});\n\nit('does not namespace already qualified define calls', () => {\n\tconst source = `\n\tOther.Namespace.define([], function(){})\n\t`;\n\n\tconst {code} = babel.transform(source, {\n\t\tfilenameRelative: __filename,\n\t\tplugins: [plugin],\n\t});\n\n\texpect(code).toMatchSnapshot();\n});\n\nit('namespaces references to global define identifier', () => {\n\tconst source = `\n\tif (typeof define === \"function\" && define.amd) {\n\t\tconsole.log('UMD!');\n\t}\n\t`;\n\n\tconst {code} = babel.transform(source, {\n\t\tfilenameRelative: __filename,\n\t\tplugins: [plugin],\n\t});\n\n\texpect(code).toMatchSnapshot();\n});\n\ndescribe('does not namespace references to local define identifier', () => {\n\tit('when it is a variable', () => {\n\t\tconst source = `\n\t\tlet define = 'x';\n\n\t\tif(true) {\n\t\t\tif(true) {\n\t\t\t\tconsole.log(define);\n\t\t\t}\n\t    }\n\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('when it is a function parameter', () => {\n\t\tconst source = `\n\t\tfunction fn(define) {\n\t\t\tconsole.log(define);\n\t\t};\n\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('when it is a function', () => {\n\t\tconst source = `\n\t\tfunction define(x) {\n\t\t\tconsole.log(define);\n\t\t}\n\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('when it is an object field', () => {\n\t\tconst source = `\n\t\t\tvar a = {\n\t\t\t\tdefine: function(name, value) {\n\t\t\t\t\treturn name;\n\t\t\t\t}\n\t\t\t}\n\t\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n});\n"]}