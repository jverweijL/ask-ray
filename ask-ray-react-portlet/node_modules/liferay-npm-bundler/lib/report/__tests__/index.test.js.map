{"version":3,"sources":["../../../src/report/__tests__/index.test.js"],"names":["report","beforeEach","_executionDate","Date","describe","afterEach","expect","toMatchSnapshot","it","executionTime","warn","unique","versionsInfo","linkedDependency","dependencies","id","name","version","packageCopy","packageProcessBundlerPlugin","config","cfgval1","cfgval2","run","packageProcessBabelConfig","packageProcessBabelRun","toHtml"],"mappings":"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","file":"index.test.js","sourcesContent":["import PluginLogger from 'liferay-npm-build-tools-common/lib/plugin-logger';\nimport {Report} from '../index';\n\nlet report;\n\nbeforeEach(() => {\n\treport = new Report();\n\n\t// Hack to make tests repeatable\n\treport._executionDate = new Date(0);\n});\n\ndescribe('when describing the run', () => {\n\tafterEach(() => {\n\t\texpect(report).toMatchSnapshot();\n\t});\n\n\tit('correctly stores executionTime', () => {\n\t\treport.executionTime([1, 2]);\n\t});\n\n\tit('correctly stores warnings', () => {\n\t\treport.warn('warn 1');\n\t\treport.warn('warn 2');\n\t});\n\n\tit('correctly stores unique warnings', () => {\n\t\treport.warn('warn', {unique: true});\n\t\treport.warn('warn', {unique: true});\n\t});\n\n\tit('correctly stores versions info', () => {\n\t\treport.versionsInfo({\n\t\t\t'liferay-npm-bundler': '1.4.2',\n\t\t\t'liferay-npm-bundler-plugin-inject-angular': '1.4.2',\n\t\t});\n\t});\n\n\tit('correctly stores linked dependencies', () => {\n\t\treport.linkedDependency('a-package', 'file:../a-package', '1.1.0');\n\t});\n\n\tit('correctly stores dependencies', () => {\n\t\treport.dependencies([\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{id: 'package-2@2.0.0', name: 'package-2', version: '2.0.0'},\n\t\t]);\n\t});\n\n\tit('correctly removes stale linked dependencies', () => {\n\t\treport.linkedDependency('a-package', 'file:../a-package', '1.1.0');\n\t\treport.linkedDependency('package-1', 'file:../package-1', '1.0.0');\n\t\treport.dependencies([\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{id: 'package-2@2.0.0', name: 'package-2', version: '2.0.0'},\n\t\t]);\n\t});\n\n\tit('correctly stores package copies', () => {\n\t\treport.packageCopy(\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t['a.js', 'b.js', 'c.js'],\n\t\t\t['a.js', 'c.js'],\n\t\t\t['b.*']\n\t\t);\n\t});\n\n\tit('correctly stores bundler plugin runs', () => {\n\t\treport.packageProcessBundlerPlugin(\n\t\t\t'pre',\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{\n\t\t\t\tname: 'a-plugin',\n\t\t\t\tconfig: {cfgval1: 1, cfgval2: 2},\n\t\t\t\trun: () => '',\n\t\t\t},\n\t\t\tnew PluginLogger()\n\t\t);\n\t});\n\n\tit('correctly stores Babel config', () => {\n\t\treport.packageProcessBabelConfig(\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{cfgval1: 1, cfgval2: 2}\n\t\t);\n\t});\n\n\tit('correctly stores Babel file run', () => {\n\t\treport.packageProcessBabelRun(\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t'a.js',\n\t\t\tnew PluginLogger()\n\t\t);\n\t});\n});\n\nit('correctly dumps HTML report', () => {\n\t// The goal of this test is to detect unwanted changes in HTML. If you make\n\t// changes to the HTML on purpose, just check it visually and update the\n\t// snapshot with Jest's -u switch.\n\n\treport.executionTime([1, 2]);\n\treport.warn('warn 1');\n\treport.warn('warn 2');\n\treport.warn('warn', {unique: true});\n\treport.warn('warn', {unique: true});\n\treport.versionsInfo({\n\t\t'liferay-npm-bundler': '1.4.2',\n\t\t'liferay-npm-bundler-plugin-inject-angular': '1.4.2',\n\t});\n\treport.linkedDependency('a-package', 'file:../a-package', '1.1.0');\n\treport.linkedDependency('package-1', 'file:../package-1', '1.0.0');\n\treport.dependencies([\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t{id: 'package-2@2.0.0', name: 'package-2', version: '2.0.0'},\n\t]);\n\treport.packageCopy(\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t['a.js', 'b.js', 'c.js'],\n\t\t['a.js', 'c.js'],\n\t\t['b.*']\n\t);\n\treport.packageProcessBundlerPlugin(\n\t\t'pre',\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t{\n\t\t\tname: 'a-plugin',\n\t\t\tconfig: {cfgval1: 1, cfgval2: 2},\n\t\t\trun: () => '',\n\t\t},\n\t\tnew PluginLogger()\n\t);\n\treport.packageProcessBabelConfig(\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t{cfgval1: 1, cfgval2: 2}\n\t);\n\treport.packageProcessBabelRun(\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t'a.js',\n\t\tnew PluginLogger()\n\t);\n\n\texpect(report.toHtml()).toMatchSnapshot();\n});\n"]}